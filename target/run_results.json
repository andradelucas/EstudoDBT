{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2024.8.221", "generated_at": "2024-08-06T12:32:06.821633Z", "invocation_id": "f05d3ede-6f27-417f-972d-caef1fcd189b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.786812Z", "completed_at": "2024-08-06T12:32:06.793015Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.794498Z", "completed_at": "2024-08-06T12:32:06.794505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013370037078857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.customers", "compiled": true, "compiled_code": "-- customers code\nWITH markup AS (\n    SELECT *,\n           first_value(customer_id) \n           OVER (PARTITION BY company_name, contact_name \n                 ORDER BY company_name\n                 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS result\n    FROM \"northwind\".\"public\".\"customers\"\n), \nremoved AS (\n    SELECT DISTINCT result \n    FROM markup\n), \nfinal AS (\n    SELECT * \n    FROM \"northwind\".\"public\".\"customers\" \n    WHERE customer_id IN (SELECT result FROM removed)\n)\n\nSELECT * \nFROM final", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.788714Z", "completed_at": "2024-08-06T12:32:06.793508Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.795276Z", "completed_at": "2024-08-06T12:32:06.795283Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013585805892944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.employees", "compiled": true, "compiled_code": "WITH calc_employees as(\nSELECT\ndate_part(year,current_date) - date_part(year,birth_date) age\n,date_part(year,current_date) - date_part(year,hire_date) lengthofservice\n,first_name || ' ' || last_name employee_name, *\nfrom\"northwind\".\"public\".\"employees\"\n)\nselect * FROM calc_employees", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"employees\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.790323Z", "completed_at": "2024-08-06T12:32:06.794098Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.796003Z", "completed_at": "2024-08-06T12:32:06.796010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013289690017700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.order_details", "compiled": true, "compiled_code": "WITH temp as(\nSELECT\nod.order_id, od.product_id, od.unit_price,od.quantity, pr.product_name, pr.supplier_id, pr.category_id\n,od.unit_price * od.quantity total\n,(pr.unit_price * od.quantity) - total discount\nfrom\"northwind\".\"public\".\"order_details\" od\nleft join  \"northwind\".\"public\".\"products\" pr on (od.product_id = pr.product_id)\n)\nselect * FROM temp", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"order_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.799364Z", "completed_at": "2024-08-06T12:32:06.804329Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.804799Z", "completed_at": "2024-08-06T12:32:06.804807Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.007309436798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_estudo.checkduplic", "compiled": true, "compiled_code": "select count(*) count, company_name, contact_name FROM\n\"northwind\".\"dbt_landradeesilva\".\"customers\"\ngroup by company_name, contact_name\nhaving count > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.801532Z", "completed_at": "2024-08-06T12:32:06.805486Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.805997Z", "completed_at": "2024-08-06T12:32:06.806003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0071563720703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.joins", "compiled": true, "compiled_code": "WITH prod as (\nSELECT\nct.category_name, sp.company_name suppliers, pd.product_name,\npd.unit_price, pd.product_id\nFROM \"northwind\".\"public\".\"products\"  pd\nLEFT JOIN \"northwind\".\"public\".\"suppliers\" sp ON pd.supplier_id = sp.supplier_id\nLEFT JOIN \"northwind\".\"public\".\"categories\" ct ON pd.category_id = ct.category_id\n), orddetai as (\n    SELECT\n        pd.*,od.order_id,od.quantity,od.discount\n    FROM \"northwind\".\"dbt_landradeesilva\".\"order_details\"  od\n    LEFT JOIN prod pd ON od.product_id = pd.product_id\n), Ordrs as( \nSELECT\n    ord.order_date\n    ,ord.order_id\n    ,cs.company_name customers\n    ,em.employee_name employees\n    ,em.age\n    ,em.lengthofservice\nFROM \"northwind\".\"public\".\"orders\" ord\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"customers\" cs ON ord.customer_id = cs.customer_id\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"employees\" em ON ord.employee_id = em.employee_id\n    LEFT JOIN    \"northwind\".\"public\".\"shippers\" sh ON ord.ship_via = sh.shipper_id\n), finaljoin as (\n\n    SELECT\n        od.*, ord.order_date, ord.customers, ord.employees, ord.age, ord.lengthofservice\n    FROM orddetai od\n    inner join Ordrs ord on od.order_id = ord.order_id\n)\n\nSELECT * FROM finaljoin", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"joins\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.810949Z", "completed_at": "2024-08-06T12:32:06.815510Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.816429Z", "completed_at": "2024-08-06T12:32:06.816436Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008174896240234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2020", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2020", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2020\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.812335Z", "completed_at": "2024-08-06T12:32:06.816010Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.817557Z", "completed_at": "2024-08-06T12:32:06.817563Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.008880138397216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2021", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2021", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2021\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T12:32:06.813923Z", "completed_at": "2024-08-06T12:32:06.817123Z"}, {"name": "execute", "started_at": "2024-08-06T12:32:06.818440Z", "completed_at": "2024-08-06T12:32:06.818448Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009210586547851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2022", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2022", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2022\""}], "elapsed_time": 0.4199390411376953, "args": {"static_parser": true, "source_freshness_run_project_hooks": false, "favor_state": false, "quiet": false, "profile": "user", "select": [], "cache_selected_only": false, "indirect_selection": "eager", "target_path": "target", "inject_ephemeral_ctes": true, "profiles_dir": "./", "require_resource_names_without_spaces": false, "log_format": "json", "print": true, "project_dir": "/app/dbt_project/0467db8f-e591-4711-858f-d22c77df3c22", "which": "compile", "use_colors": true, "show_resource_report": false, "log_path": "logs", "populate_cache": true, "log_level": "info", "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "strict_mode": false, "invocation_command": "dbt ", "introspect": true, "send_anonymous_usage_stats": true, "vars": {}, "version_check": true, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "write_json": true, "empty": false, "log_format_file": "json", "partial_parse": true, "exclude": [], "output": "text", "defer": false}}