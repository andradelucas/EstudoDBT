{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2024.8.222", "generated_at": "2024-08-06T23:03:41.241797Z", "invocation_id": "a98fdc96-5504-4601-83e6-3e1cf5eb5c36", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:23.825865Z", "completed_at": "2024-08-06T23:03:23.840033Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:23.891046Z", "completed_at": "2024-08-06T23:03:28.778162Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 6.896219253540039, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.order_details", "compiled": true, "compiled_code": "WITH temp as(\nSELECT\nod.order_id, od.product_id, od.unit_price,od.quantity, pr.product_name, pr.supplier_id, pr.category_id\n,od.unit_price * od.quantity total\n,(pr.unit_price * od.quantity) - total discount\nfrom\"northwind\".\"public\".\"order_details\" od\nleft join  \"northwind\".\"public\".\"products\" pr on (od.product_id = pr.product_id)\n)\nselect * FROM temp", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"order_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:23.824069Z", "completed_at": "2024-08-06T23:03:23.839516Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:23.871812Z", "completed_at": "2024-08-06T23:03:30.705488Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.9010632038116455, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.newshippers", "compiled": true, "compiled_code": "SELECT \n    sh.company_name, \n    se.* \nFROM\n    \"northwind\".\"public\".\"shippers\" sh\nLEFT JOIN \n    \"northwind\".\"dbt_landradeesilva\".\"shippers_emails\" se \nON \n    sh.shipper_id = se.shippers_id", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"newshippers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:23.827674Z", "completed_at": "2024-08-06T23:03:23.866224Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:23.893574Z", "completed_at": "2024-08-06T23:03:28.026679Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 6.901038885116577, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.logging.stg_dbt_audit_log", "compiled": true, "compiled_code": "with audit as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"dbt_audit_log\"\n\n),\n\nwith_id as (\n\n    select\n\n        *,\n\n        md5(cast(coalesce(cast(event_name as varchar), '') || '-' || coalesce(cast(event_model as varchar), '') || '-' || coalesce(cast(invocation_id as varchar), '') as varchar)) as event_id\n\n    from audit\n\n)\n\nselect * from with_id", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:23.820873Z", "completed_at": "2024-08-06T23:03:23.838477Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:23.840486Z", "completed_at": "2024-08-06T23:03:29.437812Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.9059929847717285, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.customers", "compiled": true, "compiled_code": "-- customers code\nWITH markup AS (\n    SELECT *,\n           first_value(customer_id) \n           OVER (PARTITION BY company_name, contact_name \n                 ORDER BY company_name\n                 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS result\n    FROM \"northwind\".\"public\".\"customers\"\n), \nremoved AS (\n    SELECT DISTINCT result \n    FROM markup\n), \nfinal AS (\n    SELECT * \n    FROM \"northwind\".\"public\".\"customers\" \n    WHERE customer_id IN (SELECT result FROM removed)\n)\n\nSELECT * \nFROM final", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:23.822629Z", "completed_at": "2024-08-06T23:03:23.838987Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:23.856064Z", "completed_at": "2024-08-06T23:03:30.087789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 6.906716346740723, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.employees", "compiled": true, "compiled_code": "WITH calc_employees as(\nSELECT\ndate_part(year,current_date) - date_part(year,birth_date) age\n,date_part(year,current_date) - date_part(year,hire_date) lengthofservice\n,first_name || ' ' || last_name employee_name, *\nfrom\"northwind\".\"public\".\"employees\"\n)\nselect * FROM calc_employees", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"employees\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:30.729826Z", "completed_at": "2024-08-06T23:03:30.740248Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:30.741166Z", "completed_at": "2024-08-06T23:03:32.524431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8320555686950684, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.logging.stg_dbt_deployments", "compiled": true, "compiled_code": "with events as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\"\n\n),\n\naggregated as (\n\n    select\n\n        invocation_id,\n        event_user as user,\n        event_target as target,\n        event_is_full_refresh as is_full_refresh,\n\n        min(case\n            when event_name = 'run started' then event_timestamp\n            end) as deployment_started_at,\n\n        min(case\n            when event_name = 'run completed' then event_timestamp\n            end) as deployment_completed_at,\n\n        count(distinct case\n            when event_name ilike '%model%' then event_model\n            end) as models_deployed\n\n    from events\n\n    group by 1,2,3,4\n\n)\n\nselect * from aggregated", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_deployments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:30.734482Z", "completed_at": "2024-08-06T23:03:30.740707Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:30.743391Z", "completed_at": "2024-08-06T23:03:32.553176Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.833651065826416, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.logging.stg_dbt_model_deployments", "compiled": true, "compiled_code": "with events as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\"\n\n),\n\naggregated as (\n\n    select\n\n        md5(cast(coalesce(cast(event_model as varchar), '') || '-' || coalesce(cast(invocation_id as varchar), '') as varchar)) as model_deployment_id,\n\n        invocation_id,\n        event_model as model,\n        event_schema as schema,\n        event_user as user,\n        event_target as target,\n        event_is_full_refresh as is_full_refresh,\n\n        min(case\n            when event_name = 'model deployment started' then event_timestamp\n        end) as deployment_started_at,\n\n        min(case\n            when event_name = 'model deployment completed' then event_timestamp\n        end) as deployment_completed_at\n\n    from events\n\n    where event_name ilike '%model%'\n\n    group by 1,2,3,4,5,6,7\n\n)\n\nselect * from aggregated", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_model_deployments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:30.737137Z", "completed_at": "2024-08-06T23:03:30.745535Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:30.746161Z", "completed_at": "2024-08-06T23:03:34.299654Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.5764341354370117, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.joins", "compiled": true, "compiled_code": "WITH prod as (\nSELECT\nct.category_name, sp.company_name suppliers, pd.product_name,\npd.unit_price, pd.product_id\nFROM \"northwind\".\"public\".\"products\"  pd\nLEFT JOIN \"northwind\".\"public\".\"suppliers\" sp ON pd.supplier_id = sp.supplier_id\nLEFT JOIN \"northwind\".\"public\".\"categories\" ct ON pd.category_id = ct.category_id\n), orddetai as (\n    SELECT\n        pd.*,od.order_id,od.quantity,od.discount\n    FROM \"northwind\".\"dbt_landradeesilva\".\"order_details\"  od\n    LEFT JOIN prod pd ON od.product_id = pd.product_id\n), Ordrs as( \nSELECT\n    ord.order_date\n    ,ord.order_id\n    ,cs.company_name customers\n    ,em.employee_name employees\n    ,em.age\n    ,em.lengthofservice\nFROM \"northwind\".\"public\".\"orders\" ord\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"customers\" cs ON ord.customer_id = cs.customer_id\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"employees\" em ON ord.employee_id = em.employee_id\n    LEFT JOIN    \"northwind\".\"public\".\"shippers\" sh ON ord.ship_via = sh.shipper_id\n), finaljoin as (\n\n    SELECT\n        od.*, ord.order_date, ord.customers, ord.employees, ord.age, ord.lengthofservice\n    FROM orddetai od\n    inner join Ordrs ord on od.order_id = ord.order_id\n)\n\nSELECT * FROM finaljoin", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"joins\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:34.313997Z", "completed_at": "2024-08-06T23:03:34.320519Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:34.321899Z", "completed_at": "2024-08-06T23:03:37.629286Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.415058374404907, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.bicategories", "compiled": true, "compiled_code": "SELECT * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere category_name = 'Seafood'", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"bicategories\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:34.316034Z", "completed_at": "2024-08-06T23:03:34.321022Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:34.325410Z", "completed_at": "2024-08-06T23:03:39.719268Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.416876792907715, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.partition2020", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2020", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2020\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:34.318891Z", "completed_at": "2024-08-06T23:03:34.324986Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:34.331454Z", "completed_at": "2024-08-06T23:03:38.995709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.417599678039551, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.partition2022", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2022", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2022\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T23:03:34.317502Z", "completed_at": "2024-08-06T23:03:34.321476Z"}, {"name": "execute", "started_at": "2024-08-06T23:03:34.328880Z", "completed_at": "2024-08-06T23:03:38.308330Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.41889214515686, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.dbt_estudo.partition2021", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2021", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2021\""}], "elapsed_time": 19.23036289215088, "args": {"log_level": "info", "send_anonymous_usage_stats": true, "printer_width": 80, "populate_cache": true, "partial_parse": true, "log_format": "json", "log_path": "logs", "invocation_command": "dbt ", "static_parser": true, "exclude": [], "vars": {}, "indirect_selection": "eager", "macro_debugging": false, "log_file_max_bytes": 10485760, "show_resource_report": false, "favor_state": false, "strict_mode": false, "log_format_file": "json", "profile": "user", "introspect": true, "partial_parse_file_diff": true, "target_path": "target", "defer": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "use_colors": true, "log_level_file": "debug", "use_colors_file": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "require_resource_names_without_spaces": false, "print": true, "profiles_dir": "./", "quiet": false, "select": [], "which": "run", "source_freshness_run_project_hooks": false, "project_dir": "/app/dbt_project/6397f10d-37e8-41c0-8073-4942bf6fd263"}}