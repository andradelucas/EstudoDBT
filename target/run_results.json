{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2024.8.221", "generated_at": "2024-08-06T15:45:41.232690Z", "invocation_id": "8f57580d-28f0-4ab7-9372-523c0f8bbcca", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.889653Z", "completed_at": "2024-08-06T15:45:40.925510Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.928371Z", "completed_at": "2024-08-06T15:45:40.928382Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04860949516296387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.customers", "compiled": true, "compiled_code": "-- customers code\nWITH markup AS (\n    SELECT *,\n           first_value(customer_id) \n           OVER (PARTITION BY company_name, contact_name \n                 ORDER BY company_name\n                 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS result\n    FROM \"northwind\".\"public\".\"customers\"\n), \nremoved AS (\n    SELECT DISTINCT result \n    FROM markup\n), \nfinal AS (\n    SELECT * \n    FROM \"northwind\".\"public\".\"customers\" \n    WHERE customer_id IN (SELECT result FROM removed)\n)\n\nSELECT * \nFROM final", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.892597Z", "completed_at": "2024-08-06T15:45:40.926233Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.929209Z", "completed_at": "2024-08-06T15:45:40.929217Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04775261878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.employees", "compiled": true, "compiled_code": "WITH calc_employees as(\nSELECT\ndate_part(year,current_date) - date_part(year,birth_date) age\n,date_part(year,current_date) - date_part(year,hire_date) lengthofservice\n,first_name || ' ' || last_name employee_name, *\nfrom\"northwind\".\"public\".\"employees\"\n)\nselect * FROM calc_employees", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"employees\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.894577Z", "completed_at": "2024-08-06T15:45:40.927265Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.930894Z", "completed_at": "2024-08-06T15:45:40.930901Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04866909980773926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.order_details", "compiled": true, "compiled_code": "WITH temp as(\nSELECT\nod.order_id, od.product_id, od.unit_price,od.quantity, pr.product_name, pr.supplier_id, pr.category_id\n,od.unit_price * od.quantity total\n,(pr.unit_price * od.quantity) - total discount\nfrom\"northwind\".\"public\".\"order_details\" od\nleft join  \"northwind\".\"public\".\"products\" pr on (od.product_id = pr.product_id)\n)\nselect * FROM temp", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"order_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.896455Z", "completed_at": "2024-08-06T15:45:40.927935Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.931609Z", "completed_at": "2024-08-06T15:45:40.931618Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.048651933670043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.logging.stg_dbt_audit_log", "compiled": true, "compiled_code": "with audit as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"dbt_audit_log\"\n\n),\n\nwith_id as (\n\n    select\n\n        *,\n\n        md5(cast(coalesce(cast(event_name as varchar), '') || '-' || coalesce(cast(event_model as varchar), '') || '-' || coalesce(cast(invocation_id as varchar), '') as varchar)) as event_id\n\n    from audit\n\n)\n\nselect * from with_id", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.914485Z", "completed_at": "2024-08-06T15:45:40.929950Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.933468Z", "completed_at": "2024-08-06T15:45:40.933475Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.049161672592163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.logging.logging-on-run-end-0", "compiled": true, "compiled_code": "\n    \n\n    insert into \"northwind\".\"dbt_landradeesilva_meta\".\"dbt_audit_log\" (\n        event_name,\n        event_timestamp,\n        event_schema,\n        event_model,\n        event_user,\n        event_target,\n        event_is_full_refresh,\n        invocation_id\n    )\n\n    values (\n        'run completed',\n        \n    \n    getdate()\n\n,\n        '',\n        '',\n        'admin',\n        'default',\n        FALSE,\n        '8f57580d-28f0-4ab7-9372-523c0f8bbcca'\n    );\n\n    commit;\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.980784Z", "completed_at": "2024-08-06T15:45:40.981326Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.987874Z", "completed_at": "2024-08-06T15:45:40.987887Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03701949119567871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_estudo.shippers_emails", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.974833Z", "completed_at": "2024-08-06T15:45:40.987015Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.989368Z", "completed_at": "2024-08-06T15:45:40.989376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05273318290710449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.logging.logging-on-run-start-2", "compiled": true, "compiled_code": "\n    \n\n    insert into \"northwind\".\"dbt_landradeesilva_meta\".\"dbt_audit_log\" (\n        event_name,\n        event_timestamp,\n        event_schema,\n        event_model,\n        event_user,\n        event_target,\n        event_is_full_refresh,\n        invocation_id\n    )\n\n    values (\n        'run started',\n        \n    \n    getdate()\n\n,\n        '',\n        '',\n        'admin',\n        'default',\n        FALSE,\n        '8f57580d-28f0-4ab7-9372-523c0f8bbcca'\n    );\n\n    commit;\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.981778Z", "completed_at": "2024-08-06T15:45:40.990165Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.993412Z", "completed_at": "2024-08-06T15:45:40.993421Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04204964637756348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_estudo.checkduplic", "compiled": true, "compiled_code": "select count(*) count, company_name, contact_name FROM\n\"northwind\".\"dbt_landradeesilva\".\"customers\"\ngroup by company_name, contact_name\nhaving count > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.984177Z", "completed_at": "2024-08-06T15:45:40.990643Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:40.994266Z", "completed_at": "2024-08-06T15:45:40.994272Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0415341854095459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.joins", "compiled": true, "compiled_code": "WITH prod as (\nSELECT\nct.category_name, sp.company_name suppliers, pd.product_name,\npd.unit_price, pd.product_id\nFROM \"northwind\".\"public\".\"products\"  pd\nLEFT JOIN \"northwind\".\"public\".\"suppliers\" sp ON pd.supplier_id = sp.supplier_id\nLEFT JOIN \"northwind\".\"public\".\"categories\" ct ON pd.category_id = ct.category_id\n), orddetai as (\n    SELECT\n        pd.*,od.order_id,od.quantity,od.discount\n    FROM \"northwind\".\"dbt_landradeesilva\".\"order_details\"  od\n    LEFT JOIN prod pd ON od.product_id = pd.product_id\n), Ordrs as( \nSELECT\n    ord.order_date\n    ,ord.order_id\n    ,cs.company_name customers\n    ,em.employee_name employees\n    ,em.age\n    ,em.lengthofservice\nFROM \"northwind\".\"public\".\"orders\" ord\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"customers\" cs ON ord.customer_id = cs.customer_id\n    LEFT JOIN    \"northwind\".\"dbt_landradeesilva\".\"employees\" em ON ord.employee_id = em.employee_id\n    LEFT JOIN    \"northwind\".\"public\".\"shippers\" sh ON ord.ship_via = sh.shipper_id\n), finaljoin as (\n\n    SELECT\n        od.*, ord.order_date, ord.customers, ord.employees, ord.age, ord.lengthofservice\n    FROM orddetai od\n    inner join Ordrs ord on od.order_id = ord.order_id\n)\n\nSELECT * FROM finaljoin", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"joins\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.007144Z", "completed_at": "2024-08-06T15:45:41.023452Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.029647Z", "completed_at": "2024-08-06T15:45:41.029654Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.033873558044433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.logging.stg_dbt_deployments", "compiled": true, "compiled_code": "with events as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\"\n\n),\n\naggregated as (\n\n    select\n\n        invocation_id,\n        event_user as user,\n        event_target as target,\n        event_is_full_refresh as is_full_refresh,\n\n        min(case\n            when event_name = 'run started' then event_timestamp\n            end) as deployment_started_at,\n\n        min(case\n            when event_name = 'run completed' then event_timestamp\n            end) as deployment_completed_at,\n\n        count(distinct case\n            when event_name ilike '%model%' then event_model\n            end) as models_deployed\n\n    from events\n\n    group by 1,2,3,4\n\n)\n\nselect * from aggregated", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_deployments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.014937Z", "completed_at": "2024-08-06T15:45:41.029045Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.037581Z", "completed_at": "2024-08-06T15:45:41.037589Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04062676429748535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.logging.stg_dbt_model_deployments", "compiled": true, "compiled_code": "with events as (\n\n    select * from \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_audit_log\"\n\n),\n\naggregated as (\n\n    select\n\n        md5(cast(coalesce(cast(event_model as varchar), '') || '-' || coalesce(cast(invocation_id as varchar), '') as varchar)) as model_deployment_id,\n\n        invocation_id,\n        event_model as model,\n        event_schema as schema,\n        event_user as user,\n        event_target as target,\n        event_is_full_refresh as is_full_refresh,\n\n        min(case\n            when event_name = 'model deployment started' then event_timestamp\n        end) as deployment_started_at,\n\n        min(case\n            when event_name = 'model deployment completed' then event_timestamp\n        end) as deployment_completed_at\n\n    from events\n\n    where event_name ilike '%model%'\n\n    group by 1,2,3,4,5,6,7\n\n)\n\nselect * from aggregated", "relation_name": "\"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_model_deployments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.026842Z", "completed_at": "2024-08-06T15:45:41.036954Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.044415Z", "completed_at": "2024-08-06T15:45:41.044423Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03819417953491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.newshippers", "compiled": true, "compiled_code": "SELECT \n    sh.company_name, \n    se.shipper_email \nFROM\n    \"northwind\".\"public\".\"shippers\" sh\nLEFT JOIN \n    \"northwind\".\"dbt_landradeesilva\".\"shippers_emails\" se \nON \n    sh.shipper_id = se.shippers_id", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"newshippers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.034430Z", "completed_at": "2024-08-06T15:45:41.043922Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.048960Z", "completed_at": "2024-08-06T15:45:41.048966Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.03493165969848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.bicategories", "compiled": true, "compiled_code": "SELECT * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere category_name = 'Seafood'", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"bicategories\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.056498Z", "completed_at": "2024-08-06T15:45:41.062898Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.065431Z", "completed_at": "2024-08-06T15:45:41.065437Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017342090606689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2020", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2020", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2020\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.059392Z", "completed_at": "2024-08-06T15:45:41.065006Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.066691Z", "completed_at": "2024-08-06T15:45:41.066697Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015687227249145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2021", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2021", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2021\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.061406Z", "completed_at": "2024-08-06T15:45:41.066194Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.068279Z", "completed_at": "2024-08-06T15:45:41.068284Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.013159513473510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_estudo.partition2022", "compiled": true, "compiled_code": "select * FROM \"northwind\".\"dbt_landradeesilva\".\"joins\"\nwhere date_part(year,order_date) = 2022", "relation_name": "\"northwind\".\"dbt_landradeesilva\".\"partition2022\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.063447Z", "completed_at": "2024-08-06T15:45:41.069057Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.070805Z", "completed_at": "2024-08-06T15:45:41.070810Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.01246333122253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.logging.deployments", "compiled": true, "compiled_code": "select\n  [deployment_started_at:aggregation] as period\n  , sum(datediff('minute', deployment_started_at, deployment_completed_at)) as total_runtime_m\n  , avg(datediff('minute', deployment_started_at, deployment_completed_at)) as avg_runtime_m\n  , sum(models_deployed) as models_deployed\nfrom\n  \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_deployments\"\nwhere\n  [deployment_started_at=daterange]\ngroup by\n  1\norder by\n  1 desc", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.073180Z", "completed_at": "2024-08-06T15:45:41.078114Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.079166Z", "completed_at": "2024-08-06T15:45:41.079171Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009355783462524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.logging.models", "compiled": true, "compiled_code": "select\n  [deployment_started_at:aggregation] as period\n  , model\n  , count(1) as deployment_count\nfrom\n  \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_model_deployments\"\nwhere\n  [deployment_started_at=daterange]\ngroup by\n  1\n  , 2\norder by\n  1 desc\n  , 2", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.076761Z", "completed_at": "2024-08-06T15:45:41.078764Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.080253Z", "completed_at": "2024-08-06T15:45:41.080259Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.008069753646850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.logging.models_summary", "compiled": true, "compiled_code": "select\n  model\n  , cast(min(deployment_started_at) as date) as first\n  , max(deployment_started_at) as last\nfrom\n  \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_model_deployments\"\nwhere\n  [deployment_started_at=daterange]\ngroup by\n  1\norder by\n  3 asc", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:41.074982Z", "completed_at": "2024-08-06T15:45:41.079840Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.081091Z", "completed_at": "2024-08-06T15:45:41.081096Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009685516357421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.logging.models_out_of_sla", "compiled": true, "compiled_code": "with\n  models_out_of_sla as (\n    select\n      model\n      , max(deployment_started_at) as last_deployment_ts\n      , datediff('hour', max(deployment_started_at), \n    getdate()\n) as hours_since_refreshed\n    from\n      \"northwind\".\"dbt_landradeesilva_meta\".\"stg_dbt_model_deployments\"\n    group by\n      1\n    having\n      max(deployment_started_at) < dateadd('hour', -24, getdate())\n  )\nselect\n  count(1)\nfrom\n  models_out_of_sla", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.937676Z", "completed_at": "2024-08-06T15:45:41.120241Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.120654Z", "completed_at": "2024-08-06T15:45:41.120661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.19096732139587402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.logging.logging-on-run-start-0", "compiled": true, "compiled_code": "\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-06T15:45:40.954480Z", "completed_at": "2024-08-06T15:45:41.223976Z"}, {"name": "execute", "started_at": "2024-08-06T15:45:41.224347Z", "completed_at": "2024-08-06T15:45:41.224353Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.29323625564575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.logging.logging-on-run-start-1", "compiled": true, "compiled_code": "", "relation_name": null}], "elapsed_time": 0.8546969890594482, "args": {"profiles_dir": "./", "introspect": true, "populate_cache": true, "partial_parse_file_diff": true, "use_colors_file": true, "profile": "user", "vars": {}, "log_level_file": "debug", "macro_debugging": false, "printer_width": 80, "empty": false, "output": "text", "quiet": false, "require_resource_names_without_spaces": false, "strict_mode": false, "exclude": [], "log_format": "json", "log_path": "logs", "use_colors": true, "version_check": true, "inject_ephemeral_ctes": true, "project_dir": "/app/dbt_project/48daccf6-04de-4e8a-a39e-a6e9bd8dbbc7", "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "json", "show_resource_report": false, "indirect_selection": "eager", "select": [], "static_parser": true, "which": "compile", "cache_selected_only": false, "write_json": true, "defer": false, "favor_state": false, "target_path": "target", "send_anonymous_usage_stats": true, "invocation_command": "dbt ", "log_level": "info"}}